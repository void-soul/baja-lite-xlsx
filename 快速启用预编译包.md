# å¿«é€Ÿå¯ç”¨é¢„ç¼–è¯‘åŒ…

## ğŸ“‹ ä¸€åˆ†é’Ÿäº†è§£

**å½“å‰æ¨¡å¼ï¼š** æºç å‘å¸ƒï¼ˆç”¨æˆ·éœ€è¦ç¼–è¯‘ï¼‰  
**é¢„ç¼–è¯‘æ¨¡å¼ï¼š** æä¾›é¢„ç¼–è¯‘åŒ…ï¼ˆç”¨æˆ·æ— éœ€ç¼–è¯‘ï¼Œå®‰è£…å¿«é€Ÿï¼‰

**å¥½å¤„ï¼š**
- âœ… ç”¨æˆ·å®‰è£…å¿« 10 å€ï¼ˆå‡ ç§’ vs å‡ åˆ†é’Ÿï¼‰
- âœ… ç”¨æˆ·æ— éœ€å®‰è£… VSã€Pythonã€vcpkg ç­‰
- âœ… å®‰è£…æˆåŠŸç‡æ¥è¿‘ 100%

**ä»£ä»·ï¼š**
- âš ï¸ éœ€è¦ GitHub ä»“åº“
- âš ï¸ éœ€è¦é…ç½® CI/CD è‡ªåŠ¨æ„å»º
- âš ï¸ åŒ…ä½“ç§¯ç¨å¤§ï¼ˆä½†ç”¨æˆ·ä¸‹è½½çš„è¿˜æ˜¯å°ï¼‰

---

## ğŸš€ å¿«é€Ÿå¼€å§‹ï¼ˆ3æ­¥ï¼‰

### ç¬¬1æ­¥ï¼šå®‰è£…ä¾èµ–

```bash
npm install --save prebuild-install
npm install --save-dev prebuild
```

### ç¬¬2æ­¥ï¼šæ›¿æ¢ package.json

```bash
# å¤‡ä»½å½“å‰ package.json
cp package.json package.json.backup

# ä½¿ç”¨é¢„ç¼–è¯‘ç‰ˆæœ¬
cp package-prebuild.json package.json
```

æˆ–æ‰‹åŠ¨ä¿®æ”¹ `package.json`ï¼š

```json
{
  "scripts": {
    "install": "prebuild-install --runtime napi || node-gyp rebuild",
    "prebuild": "prebuild --runtime napi --target 8 --strip"
  },
  "binary": {
    "napi_versions": [3, 4, 5, 6, 7, 8]
  },
  "dependencies": {
    "prebuild-install": "^7.1.1"
  },
  "devDependencies": {
    "prebuild": "^12.1.0"
  }
}
```

### ç¬¬3æ­¥ï¼šé…ç½® GitHub Actions

```bash
# ç¡®ä¿ .github/workflows/prebuild.yml å­˜åœ¨
# å·²ä¸ºä½ åˆ›å»ºå¥½äº†ï¼ŒæŸ¥çœ‹è¯¥æ–‡ä»¶
```

---

## ğŸ“¦ å‘å¸ƒæµç¨‹

### è‡ªåŠ¨å‘å¸ƒï¼ˆæ¨èï¼‰

```bash
# 1. æäº¤ä»£ç 
git add .
git commit -m "feat: æ·»åŠ é¢„ç¼–è¯‘æ”¯æŒ"
git push

# 2. åˆ›å»ºå¹¶æ¨é€ tag
npm version 1.0.1
git push origin v1.0.1

# 3. GitHub Actions è‡ªåŠ¨æ‰§è¡Œï¼š
#    âœ… åœ¨ Windows/Linux/macOS ä¸Šæ„å»º
#    âœ… ä¸Šä¼ é¢„ç¼–è¯‘åŒ…åˆ° GitHub Releases
#    âœ… å¤§çº¦éœ€è¦ 15-20 åˆ†é’Ÿ

# 4. ç­‰ Actions å®Œæˆåï¼Œå‘å¸ƒåˆ° npm
npm publish
```

### æ‰‹åŠ¨æ„å»ºï¼ˆæœ¬åœ°æµ‹è¯•ï¼‰

```bash
# Windows ä¸Š
npm run build
npm run prebuild

# æŸ¥çœ‹ç”Ÿæˆçš„é¢„ç¼–è¯‘åŒ…
ls prebuilds/
# è¾“å‡º: baja-lite-xlsx-v1.0.0-napi-v8-win32-x64.tar.gz
```

---

## âœ… éªŒè¯

### æ£€æŸ¥ GitHub Release

1. è®¿é—® `https://github.com/yourusername/baja-lite-xlsx/releases`
2. åº”è¯¥çœ‹åˆ°ç±»ä¼¼çš„æ–‡ä»¶ï¼š
   ```
   baja-lite-xlsx-v1.0.1-napi-v8-win32-x64.tar.gz
   baja-lite-xlsx-v1.0.1-napi-v8-linux-x64.tar.gz
   baja-lite-xlsx-v1.0.1-napi-v8-darwin-x64.tar.gz
   baja-lite-xlsx-v1.0.1-napi-v8-darwin-arm64.tar.gz
   ```

### æµ‹è¯•ç”¨æˆ·å®‰è£…

```bash
# åœ¨å¹²å‡€çš„ç¯å¢ƒï¼ˆæ— ç¼–è¯‘å·¥å…·ï¼‰
mkdir test-install
cd test-install
npm init -y
npm install baja-lite-xlsx

# åº”è¯¥çœ‹åˆ°ï¼š
# > prebuild-install info begin Prebuild-install version X.X.X
# > prebuild-install info install installing standalone from url
# âœ“ å®‰è£…æˆåŠŸï¼ˆå‡ ç§’é’Ÿï¼‰
```

---

## ğŸ” å¯¹æ¯”

### å½“å‰æ¨¡å¼ï¼ˆæºç å‘å¸ƒï¼‰

```bash
$ npm install baja-lite-xlsx
â° å®‰è£…æ—¶é—´ï¼š3-10 åˆ†é’Ÿ
ğŸ“‹ éœ€è¦ç¯å¢ƒï¼š
  - Visual Studio Build Tools
  - Python
  - vcpkg + xlnt
âŒ å¯èƒ½å¤±è´¥
```

### é¢„ç¼–è¯‘æ¨¡å¼

```bash
$ npm install baja-lite-xlsx
âš¡ å®‰è£…æ—¶é—´ï¼š3-10 ç§’
ğŸ“‹ éœ€è¦ç¯å¢ƒï¼šæ— 
âœ… å‡ ä¹ä¸ä¼šå¤±è´¥
```

---

## ğŸ“Š ç»Ÿè®¡ç¤ºä¾‹

æµè¡Œçš„é¢„ç¼–è¯‘åŒ…ä¸‹è½½ç»Ÿè®¡ï¼š

| åŒ…å | å‘¨ä¸‹è½½é‡ | é¢„ç¼–è¯‘ç‡ |
|------|---------|---------|
| sharp | 400ä¸‡ | ~95% |
| sqlite3 | 200ä¸‡ | ~90% |
| canvas | 150ä¸‡ | ~92% |

ä½¿ç”¨é¢„ç¼–è¯‘åŒ…åï¼Œä½ çš„åŒ…ä¹Ÿèƒ½è¾¾åˆ°ç±»ä¼¼çš„æˆåŠŸç‡ï¼

---

## ğŸ› ï¸ æ•…éšœæ’é™¤

### Q: Actions æ„å»ºå¤±è´¥ï¼Ÿ

**æ£€æŸ¥ï¼š**
1. VCPKG_ROOT ç¯å¢ƒå˜é‡è®¾ç½®æ­£ç¡®
2. xlnt å®‰è£…æˆåŠŸ
3. æŸ¥çœ‹ Actions æ—¥å¿—è¯¦ç»†é”™è¯¯

### Q: ç”¨æˆ·ä¸‹è½½é¢„ç¼–è¯‘åŒ…å¤±è´¥ï¼Ÿ

**åŸå› ï¼š**
- GitHub è®¿é—®å—é™
- æ²¡æœ‰å¯¹åº”å¹³å°çš„é¢„ç¼–è¯‘åŒ…

**è§£å†³ï¼š**
ä¼šè‡ªåŠ¨å›é€€åˆ°æºç ç¼–è¯‘ï¼ˆ`|| node-gyp rebuild`ï¼‰

### Q: å¦‚ä½•åªä¸ºç‰¹å®šå¹³å°æ„å»ºï¼Ÿ

ä¿®æ”¹ `.github/workflows/prebuild.yml`ï¼Œåˆ é™¤ä¸éœ€è¦çš„ jobã€‚

---

## ğŸ’¡ æœ€ä½³å®è·µ

### 1. ä¿ç•™æºç ç¼–è¯‘ä½œä¸ºåå¤‡

```json
"install": "prebuild-install --runtime napi || node-gyp rebuild"
```

è¿™æ ·å³ä½¿ä¸‹è½½å¤±è´¥ï¼Œç”¨æˆ·ä»å¯ç¼–è¯‘ã€‚

### 2. ä½¿ç”¨ N-API

å·²é…ç½®ï¼š
```json
"binary": {
  "napi_versions": [3, 4, 5, 6, 7, 8]
}
```

å¥½å¤„ï¼šä¸€ä¸ªæ„å»ºæ”¯æŒå¤šä¸ª Node.js ç‰ˆæœ¬

### 3. å¯ç”¨ strip

```json
"prebuild": "prebuild --runtime napi --target 8 --strip"
```

ç§»é™¤è°ƒè¯•ç¬¦å·ï¼Œå‡å° 50% ä½“ç§¯ã€‚

### 4. å¤š Node.js ç‰ˆæœ¬æµ‹è¯•

åœ¨ Actions ä¸­æµ‹è¯• Node 16ã€18ã€20ã€‚

---

## ğŸ“ Checklist

å¯ç”¨é¢„ç¼–è¯‘åŒ…å‰ç¡®è®¤ï¼š

- [ ] æœ‰ GitHub ä»“åº“
- [ ] å·²å®‰è£… `prebuild` å’Œ `prebuild-install`
- [ ] å·²é…ç½® `.github/workflows/prebuild.yml`
- [ ] å·²æ›´æ–° `package.json`
- [ ] å·²æµ‹è¯•æœ¬åœ°æ„å»º
- [ ] å·²æ¨é€ä»£ç åˆ° GitHub
- [ ] å‡†å¤‡å¥½åˆ›å»º Release

---

## ğŸ¯ ä¸‹ä¸€æ­¥

1. **ç°åœ¨å°±è¯•è¯•ï¼š** æŒ‰ç…§ä¸Šé¢ 3 æ­¥é…ç½®
2. **æ¨é€ tag æµ‹è¯•ï¼š** `git tag v1.0.1-beta && git push origin v1.0.1-beta`
3. **è§‚å¯Ÿ Actionsï¼š** æŸ¥çœ‹ GitHub Actions æ„å»ºè¿‡ç¨‹
4. **éªŒè¯ä¸‹è½½ï¼š** åœ¨æ–°ç¯å¢ƒå®‰è£…æµ‹è¯•
5. **æ­£å¼å‘å¸ƒï¼š** ä¸€åˆ‡æ­£å¸¸åï¼Œå‘å¸ƒæ­£å¼ç‰ˆæœ¬

---

## ğŸ“š ç›¸å…³æ–‡æ¡£

- è¯¦ç»†æŒ‡å—ï¼š[PREBUILD_GUIDE.md](PREBUILD_GUIDE.md)
- GitHub Actionsï¼š[.github/workflows/prebuild.yml](.github/workflows/prebuild.yml)
- é¢„ç¼–è¯‘ç‰ˆ package.jsonï¼š[package-prebuild.json](package-prebuild.json)

---

**éœ€è¦å¸®åŠ©ï¼Ÿ** æŸ¥çœ‹ [PREBUILD_GUIDE.md](PREBUILD_GUIDE.md) è·å–æ›´å¤šç»†èŠ‚ï¼

